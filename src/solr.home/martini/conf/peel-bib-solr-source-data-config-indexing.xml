<dataConfig>
    <dataSource name="file" type="FileDataSource"/>
    <document>
        <!-- this outer processor generates a list of files satisfying the conditions
            specified in the attributes -->
        <entity name="bib" dataSource="null"
            processor="FileListEntityProcessor"
            fileName="^.*\.xml$" recursive="true" rootEntity="false" onError="continue"
            baseDir="${dataimporter.request.baseDir}" 
            >
            <entity name="xml" processor="XPathEntityProcessor" url="${bib.fileAbsolutePath}" 
                transformer="TemplateTransformer,RegexTransformer,LogTransformer" 
                logTemplate="      file ${bib.fileAbsolutePath}"
                logLevel="debug" 
                forEach="/response/result/doc" rootEntity="true" dataSource="file" onError="skip">
                <!-- utility fields -->
                <field column="uid" xpath="/response/result/doc/str[@name='uid']"/>
                <field column="uri" xpath="/response/result/doc/str[@name='uri']"/>
                
                <field column="language" xpath="/response/result/doc/arr[@name='language']/str"/>
                <field column="pubyear" xpath="/response/result/doc/str[@name='pubyear']"/>
                <field column="actyear" xpath="/response/result/doc/str[@name='actyear']"/>
                <field column="peelnum" xpath="/response/result/doc/str[@name='peelnum']"/>
                <field column="peel1" xpath="/response/result/doc/str[@name='peel1']"/>
                <field column="peel2" xpath="/response/result/doc/str[@name='peel2']"/>
                <field column="collection" xpath="/response/result/doc/str[@name='collection']"/>
                <field column="index" template="peelbib"/>
                <field column="digstatus" xpath="/response/result/doc/str[@name='digstatus']"/>
                <field column="oaiset" xpath="/response/result/doc/str[@name='oaiset']"/>
                <field column="rectype" xpath="/response/result/doc/str[@name='rectype']"/>
                <field column="mountDate" xpath="/response/result/doc/str[@name='mountDate']"/>
                <!-- index fields -->
                <field column="title" xpath="/response/result/doc/str[@name='title']"/>
                <field column="author" xpath="/response/result/doc/str[@name='author']"/>
                <field column="subject_en" xpath="/response/result/doc/arr[@name='subject_en']/str"/>
                <field column="subject_fr" xpath="/response/result/doc/arr[@name='subject_fr']/str"/>
                <field column="bibrecord" xpath="/response/result/doc/arr[@name='bibrecord']/str"/>
                <!-- display fields -->
                <field column="subjectdisplay_en" xpath="/response/result/doc/arr[@name='subjectdisplay_en']/str"/>
                <field column="subjectdisplay_fr" xpath="/response/result/doc/arr[@name='subjectdisplay_fr']/str"/>
                <field column="geodisplay_en" xpath="/response/result/doc/arr[@name='geodisplay_en']/str"/>
                <field column="geodisplay_fr" xpath="/response/result/doc/arr[@name='geodisplay_fr']/str"/>
                <field column="origindisplay" xpath="/response/result/doc/arr[@name='origindisplay']/str"/>
                <field column="titledisplay" xpath="/response/result/doc/str[@name='titledisplay']"/>
                <field column="authordisplay" xpath="/response/result/doc/str[@name='authordisplay']"/>
                <!-- sort fields -->
                <field column="titlesort" xpath="/response/result/doc/str[@name='titlesort']"/>
                <field column="authorsort" xpath="/response/result/doc/str[@name='authorsort']"/>
            </entity>
        </entity>
    </document>
</dataConfig>
